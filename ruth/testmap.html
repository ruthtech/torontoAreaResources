<!DOCTYPE html>
<html>
<head>
    <meta charset=utf-8 />
    <title>Test the Mapbox API</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
	<script src="./login.js"></script>
    <script src='https://api.mapbox.com/mapbox-gl-js/v1.4.1/mapbox-gl.js'></script>
	<link href='https://api.mapbox.com/mapbox-gl-js/v1.4.1/mapbox-gl.css' rel='stylesheet' />
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" type="text/javascript"></script>

<style>
body {
	margin: 0;
	padding: 0;
}

#map {
	position: absolute;
	top: 0;
	bottom: 0;
	width: 100%;
}
</style>
</head>
<body>
	<!-- How to construct a map for a location (hard-code Toronto). -->

	<div id='map'></div>
	   	<script>
	   	$(document).ready(
	   	     function () {
	 	        if(!Login.isAPIKeySet()) {
		        	// move to next page
		        	window.location = "./login.html";
		        }
	   	     }
	   	);
   	</script>
	
	<script>
		// 9 shows Toronto and surrounding areas. 
		// 12 shows the city. 
		// 15 zooms in to Eglinton and Bathurst. 
		let zoomLevel = 12;
		let torontoLat = 43.7;
		let torontoLon = -79.42;
		let schoolLat =  43.7765020619;
		let schoolLon = -79.3851899865;
		
		mapboxgl.accessToken = Login.retrieveAPIKey();
		let map = new mapboxgl.Map({
			  container: 'map', // HTML container id
			  style: 'mapbox://styles/mapbox/streets-v11', // style URL
			  center: [schoolLon, schoolLat], // starting position as [lng, lat]
			  zoom: zoomLevel
			});
		
		let marker = new mapboxgl.Marker()
		  .setLngLat([schoolLon, schoolLat])
		  .addTo(map);
		
		let popup = new mapboxgl.Popup()
		  .setHTML('<h3>A School</h3><p>A good elementary school</p>');
</script>

</body>
</html>